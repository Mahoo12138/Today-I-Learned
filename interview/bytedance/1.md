## 数组存储怎么压缩？(提示：稀疏矩阵，三元组有关知识)

数组存储的压缩通常涉及到稀疏矩阵的处理，其中大部分元素为零。一种有效的方法是使用**三元组表示法**。在这种表示法中，**只存储非零元素的值以及它们的行和列的位置**。

> 在矩阵中，若数值为 0 的元素数目远远多于非 0 元素的数目，并且非 0 元素分布没有规律时，则称该矩阵为**稀疏矩阵**；与之相反，若非 0 元素数目占大多数时，则称该矩阵为**稠密矩阵**。

这样，对于一个稀疏矩阵，我们只需要存储非零元素的信息，而对于零元素，可默认它们的值都为零，无需额外存储。

最常用的稀疏矩阵存储格式主要有：**COO（Coordinate Format）**和 **CSR（Compressed Sparse Row）**。

COO 即使用 3 个数组（三元组）：

- **值数组（values）：** 存储非零元素的值。
- **行索引数组（row indices）：** 存储每个非零元素所在的行。

- **列索引数组（column indices）：** 存储每个非零元素所在的列。

举个例子，如果有一个矩阵：
$$
\begin{array}{*{20}{c}}
1&7&0&0\\
0&2&8&0\\
5&0&3&9\\
0&6&0&4
\end{array}
$$
用三元组表示法就是：

| type           | value               |
| -------------- | ------------------- |
| Values         | [1,7,2,8,5,3,9,6,4] |
| Row Indices    | [0,0,1,1,2,2,2,3,3] |
| Column Indices | [0,1,1,2,0,2,3,1,3] |

这种方式简单，但是记录单信息多（行列），每个三元组自己可以定位，因此空间不是最优。

CSR 稍复杂， 也需要三类数据来表达：数值，列号，以及**行偏移**。

+ **行偏移（row offsets）**：表示某一行的第一个元素在 values 里面的起始偏移位置；

| type                     | value               |
| ------------------------ | ------------------- |
| Values                   | [1,7,2,8,5,3,9,6,4] |
| Row offsets (item count) | [0,2,4,7,9]         |
| Column Indices           | [0,1,1,2,0,2,3,1,3] |

CSR 是比较标准的一种，其不是三元组，而是整体的编码方式。