# Z-Fightingï¼ˆZ è½´é—ªçƒï¼‰

Z-Fighting æ˜¯æŒ‡ï¼š**ä¸¤ä¸ªæˆ–å¤šä¸ªé¢éå¸¸æ¥è¿‘æˆ–é‡å æ—¶ï¼Œæ·±åº¦ç¼“å†²åŒºï¼ˆz-bufferï¼‰æ— æ³•ç²¾ç¡®åŒºåˆ†å®ƒä»¬çš„å…ˆåé¡ºåºï¼Œä»è€Œåœ¨æ¸²æŸ“æ—¶â€œé—ªçƒâ€æˆ–äº¤æ›¿å‡ºç°â€**ï¼Œçœ‹èµ·æ¥å°±åƒä¸¤ä¸ªé¢åœ¨æ‰“æ¶ã€é—ªç°ã€é¢¤æŠ–ä¸€æ ·ã€‚

## ä¸ºä»€ä¹ˆä¼šå‡ºç°ï¼Ÿ

Three.js ä½¿ç”¨ WebGL æ¸²æŸ“ï¼Œå®ƒçš„åº•å±‚é çš„æ˜¯ GPU çš„**æ·±åº¦ç¼“å†²ï¼ˆZ-Bufferï¼‰**æ¥åˆ¤æ–­å“ªä¸ªåƒç´ åœ¨â€œä¸Šé¢â€ã€‚

é—®é¢˜åœ¨äºï¼š

- Z-buffer çš„ç²¾åº¦æ˜¯æœ‰é™çš„ï¼ˆé€šå¸¸ 16ã€24 æˆ– 32 ä½ï¼‰
- å½“ä¸¤ä¸ªé¢éå¸¸éå¸¸è¿‘ï¼ˆæˆ–é‡åˆï¼‰æ—¶ï¼Œå®ƒä»¬çš„ Z å€¼å‡ ä¹ä¸€æ ·
- GPU æ— æ³•åˆ¤æ–­è°åœ¨å‰ï¼Œç»“æœå°±æ˜¯æ¸²æŸ“æ—¶â€œæ‘‡æ‘†ä¸å®šâ€

## å¸¸è§è§¦å‘åœºæ™¯

| åœºæ™¯                      | æè¿°                                                         |
| ------------------------- | ------------------------------------------------------------ |
| ä¸¤ä¸ªé¢è´´å¾—éå¸¸è¿‘          | æ¯”å¦‚ä¸€ä¸ªåœ°æ¿ï¼Œä¸€ä¸ªè´´å›¾è¦†ç›–åœ¨ä¸Šé¢                             |
| æ¨¡å‹è¢« clone ä¸€ä»½é‡å æ˜¾ç¤º | æ²¡é”™ï¼Œclone æ¨¡å‹æ²¡åç§»ï¼Œå°±ç­‰ç€æ‰“æ¶å§ ğŸ˜‚                       |
| æ¨¡å‹æ”¾åœ¨è¿œå¤„              | Z-buffer ç²¾åº¦åœ¨è¿œè·ç¦»å¤„é™ä½ï¼Œé—®é¢˜æ›´å®¹æ˜“å‘ç”Ÿ                  |
| å¤§ near/far æ¯”ä¾‹å·®è·      | ç›¸æœºçš„ near å¾ˆå°ï¼ˆæ¯”å¦‚ 0.1ï¼‰ï¼Œfar å¾ˆå¤§ï¼ˆæ¯”å¦‚ 10000ï¼‰ï¼Œå¯¼è‡´ç²¾åº¦ä¸å¤Ÿ |

## è§£å†³æ–¹æ³•

### 1. **é¿å…é¢é‡å **

è¿™æ˜¯æœ€æ ¹æœ¬çš„åŠæ³•ï¼š

```js
mesh2.position.z += 0.001; // å¾®ç§»ä¸€ç‚¹ç‚¹ï¼Œé¿å…é‡å 
```

### 2. **ä¼˜åŒ–ç›¸æœº near/far è®¾ç½®**

è®© `near` å’Œ `far` å°½å¯èƒ½æ¥è¿‘ï¼ˆç¼©å°å®ƒä»¬çš„æ¯”å€¼ï¼‰ï¼š

```js
const camera = new THREE.PerspectiveCamera(
  75,
  window.innerWidth / window.innerHeight,
  1,     // æ”¹å°ä¸€ç‚¹
  1000   // ä¸è¦è®¾å¤ªå¤§ï¼Œé™¤éä½ çœŸçš„å¾ˆè¿œ
);
```

### 3. **ä½¿ç”¨ `polygonOffset` å±æ€§ï¼ˆé’ˆå¯¹æè´¨ï¼‰**

è¿™æ˜¯ Three.js é’ˆå¯¹â€œæ·±åº¦åç§»â€çš„å®˜æ–¹è§£å†³æ‰‹æ®µï¼š

```js
const material = new THREE.MeshBasicMaterial({
  map: texture,
  polygonOffset: true,
  polygonOffsetFactor: 1,
  polygonOffsetUnits: 1
});
```

è¿™ä¸ªè®¾ç½®ä¼šè®©è¿™ä¸ªæè´¨çš„é¢åœ¨ z-buffer ä¸­è½»å¾®â€œåé€€â€ï¼Œä»è€Œé¿å…è·Ÿå…¶å®ƒé¢å†²çªã€‚

>  `polygonOffsetFactor/Units` æ§åˆ¶åç§»çš„å¼ºåº¦