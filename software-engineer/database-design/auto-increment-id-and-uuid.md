---
title: 自增主键与 UUID
---
在数据库设计中，通常在已有自增整数 `id` 作为主键的基础上，仍额外添加 `uuid` 字段，主要是有以下考量：

## 一、安全性与隐私保护

1. ​**​防止枚举攻击​**​
    - 自增 ID（如 `123`）易被猜测，攻击者可遍历 ID 爬取数据（如 `124`, `125`）。
    - UUID（如 `d3b7a3e9-1f1a-4b2c-9f4d-6e3c8b5a2d1c`）为随机字符串，无法通过递增推测，显著提升安全性。
2. ​**​隐藏业务规模​**​
    - 自增 ID 暴露数据量（如用户数），而 UUID 无此问题，避免泄露业务信息。

## 二、分布式系统与全局唯一性

1. ​**​跨数据库/分片的唯一性​**​
    - 自增 ID 在分库分表或分布式系统中可能重复（如不同分片生成相同 ID）。
    - UUID 全局唯一，无需中央协调，天然适配分布式架构。
2. ​**​离线生成与预知 ID​**​
    - UUID 可在客户端生成并直接插入，无需等待数据库返回自增 ID，适用于离线场景（如移动端数据同步）。

## 三、业务与系统集成需求

1. ​**​跨系统标识符​**​
    - 微服务或多系统交互时，UUID 可作为统一业务实体标识，避免不同数据库自增 ID 冲突。
    - 例如：订单系统生成 UUID，支付系统通过该 ID 关联订单，无需依赖对方数据库的自增 ID。
2. ​**​数据迁移与合并​**​
    - 合并不同数据库时，自增 ID 易冲突（如两个库均有用户ID `1001`），而 UUID 天然避免冲突。

## 四、性能与存储的权衡

1. ​**​主键索引效率​**​
    - 自增 ID 作为主键时，按顺序写入，减少 B+ 树页分裂，提升插入性能。
    - UUID 作为主键时，随机写入可能导致页分裂，降低性能。
2. ​**​存储优化​**​
    - 自增 ID（4字节）比 UUID（16字节）更节省空间，尤其在大表中显著减少索引大小，提升查询速度。